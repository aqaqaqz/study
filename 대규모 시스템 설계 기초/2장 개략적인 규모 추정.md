# 개략적인 규모 추정
- 보편적으로 통용되는 성능 수치상에서 사고실험을 통하여 추정치를 계산하는 것
- 어떤 설계가 요구사항에 부합할 거싱ㄴ지 보기 위한 것
- 2의 제곱수나 응답지연 값, 가용성에 관계된 수치의 이해가 필요
##### 2의 제곱수
- 데이터 볼륨의 단위가 2의 제곱수로 표현되는 방법을 알아야 한다
    - 8비트 = 1바이트(최소단위)
    - 2^10 바이트 = 1킬로바이트(1KB)[근사치 1천]
    - 2^20 바이트 = 1메가바이트(1MB)[근사치 1백만]
    - 2^30 바이트 = 1기가밥이트(1GB)[근사치 10억]
    - 2^40 바이트 = 1테라바이트(1TB)[근사치 1조]
    - 2^50 바이트 = 1페타바이트(1PB)[근사치 1000조]

##### 응답지연 값
- 완벽에 가까운 수치는 아니지만 어느정도인지 알고 있어야 한다
    - L1 캐시 참조 : 0.5ns
    - 분기 예측 오류 : 5ns
        - 성능 향상을 위해 if, while 등 미리 예측하는것
    - L2 캐시 참조 : 7ns
    - 뮤텍스 락/언락 : 100ns
        - 하나의 공유자원
    - 주 메모리 참조 : 100ns
    - Zippy로 1 KB 압축 : 10,000ns
    - 1Gbps 네트워크로 2KB 전송 : 20,000ns
    - 메모리에서 1MB 순차적 read : 250,000ns
    - 디스크 탐색 : 10ms
        - 특성 실린더로 디스크 헤드가 이동하는 시간
    - 네트워크에서 1MB 순차적 read : 10ms
    - 디스크에서 1MB 순차적 read : 30ms
    - 한 패킷의 캘리포니아~네덜란드의 왕복 지연시간 : 150ms
- 위 지연시간을 확인하여 알 수 있는 내용들
    - 메모리는 빠르지만 디스크는 느리다
    - 디스크 탐색은 가능한 피하라
    - 단순한 압축 알고리즘은 빠르다
    - 데이터를 인터넷으로 전송하기 전에 압축해라

##### 가용성에 관계된 수치들
- 가용성 : 시스템이 지속적으로 중단 없이 운영될 수 있는 능력
- 단위는 %(100% -> 시스템이 한 번도 중단된 적이 없음을 의미)
- SLA(Service Level Agreement) : 사업자와 고객 사이에 맺어진 합의
    - 아마존, 구글, 마소 같은 사업자는 99% 이상의 SLA를 제공

##### 예제
- QPS(Query Per Second)와 저장소 요구량을 구해보자
- 전체 유저, 매일 사용하는 유저 수, 각 유저의 매일 사용량, 데이터의 종류, 데이터의 보존 기간
    - 3억의 유저 중 50%의 사용자가 하루평균 2건의 데이터를 발생시키고, 그 중에 미디어는 10%이며 모든 데이터는 5년간 보관된다
        - QPS : 3억 * 0.5 * (2/24/60/60)
        - 이용자가 몰리는 시간도 있으니 최대 QPS는 좀더 넉넉하게
    - 하나의 데이터는 ID(64byte), 텍스트(140byte), 미디어(1MB)를 사용한다고 가정
        - 3억 * 0.5 * (2 * 1MB * 0.1) * 5Y

##### 팁
- 이런 유형의 면접은 문제 해결능력을 보고 싶어하는 것
    - 근사치를 활용하라. 계산 결과가 중요한게 아니다
    - 나중에 살펴볼 수 있도록 가정은 적어두라
    - 헷갈리지 않게 단위를 꼭 명시하라
    - 보통 QPS, 최대 QPS, 저장소 요구량, 캐시 요구량, 서버 수 등이 면접에서 많이 나오니 미리 연습하라
        
